<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MINT NFT PET - GOLD PREMIUM | Solana Tamagotchi</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Press Start 2P', cursive;
            background: linear-gradient(135deg, #1a0f00 0%, #2d1b0a 50%, #1a0f00 100%);
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.08) 0%, transparent 50%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        
        /* HEADER - GOLD PREMIUM */
        .header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s ease;
        }
        .header h1 {
            font-size: 32px;
            background: linear-gradient(135deg, #FFD700, #FFA500, #FFD700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 40px rgba(255, 215, 0, 0.6);
            margin-bottom: 10px;
            letter-spacing: 2px;
            animation: goldShine 3s ease-in-out infinite;
        }
        .header .subtitle {
            font-size: 12px;
            color: #FFD700;
            opacity: 0.9;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        
        /* WALLET SECTION - GOLD */
        .wallet-section {
            background: rgba(255, 215, 0, 0.05);
            border: 2px solid rgba(255, 215, 0, 0.4);
            border-radius: 15px;
            padding: 15px 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.2);
        }
        .wallet-info {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .wallet-info div {
            font-size: 10px;
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
        }
        .btn-connect {
            padding: 12px 24px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border: none;
            border-radius: 10px;
            color: #1a0f00;
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            font-weight: bold;
        }
        .btn-connect:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.8);
        }
        
        /* TIER GRID - GOLD CARDS */
        .tier-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            justify-content: center;
            margin-bottom: 40px;
        }
        @media (max-width: 1400px) {
            .tier-grid {
                display: flex;
                flex-wrap: wrap;
                overflow-x: auto;
            }
        }
        
        .tier-card {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.05), rgba(26, 15, 0, 0.3));
            backdrop-filter: blur(20px);
            border: 3px solid;
            border-radius: 20px;
            padding: 25px 20px;
            width: 100%;
            min-height: 650px;
            display: flex;
            flex-direction: column;
            position: relative;
            transition: all 0.4s;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
        }
        .tier-card:hover {
            transform: translateY(-10px) scale(1.02);
        }
        .tier-card.bronze { 
            border-color: #CD7F32;
            box-shadow: 0 0 30px rgba(205, 127, 50, 0.4);
        }
        .tier-card.bronze:hover {
            box-shadow: 0 0 50px rgba(205, 127, 50, 0.7), 0 0 80px rgba(205, 127, 50, 0.5);
        }
        .tier-card.silver { 
            border-color: #C0C0C0;
            box-shadow: 0 0 30px rgba(192, 192, 192, 0.4);
        }
        .tier-card.silver:hover {
            box-shadow: 0 0 50px rgba(192, 192, 192, 0.7), 0 0 80px rgba(192, 192, 192, 0.5);
        }
        .tier-card.gold { 
            border-color: #FFD700;
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.6);
            animation: goldCardGlow 3s ease-in-out infinite;
        }
        .tier-card.gold:hover {
            box-shadow: 0 0 60px rgba(255, 215, 0, 1), 0 0 100px rgba(255, 215, 0, 0.8);
        }
        .tier-card.platinum { 
            border-color: #E5E4E2;
            box-shadow: 0 0 30px rgba(229, 228, 226, 0.4);
        }
        .tier-card.platinum:hover {
            box-shadow: 0 0 50px rgba(229, 228, 226, 0.7), 0 0 80px rgba(229, 228, 226, 0.5);
        }
        .tier-card.diamond { 
            border-color: #FFD700;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.8);
            animation: diamondGoldGlow 2s ease-in-out infinite;
        }
        .tier-card.diamond:hover {
            box-shadow: 0 0 80px rgba(255, 215, 0, 1), 0 0 120px rgba(255, 215, 0, 0.9);
        }
        
        .fomo-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #FF6B35, #FFD700);
            color: #1a0f00;
            font-size: 9px;
            padding: 6px 10px;
            border-radius: 15px;
            animation: goldPulse 2s infinite;
            z-index: 10;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
            font-weight: bold;
        }
        .tier-icon {
            font-size: 50px;
            text-align: center;
            margin: 10px 0;
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.6));
            animation: iconGoldFloat 3s ease-in-out infinite;
        }
        .tier-name {
            font-size: 16px;
            text-align: center;
            margin: 8px 0;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
        }
        .tier-supply {
            font-size: 9px;
            text-align: center;
            color: #FFD700;
            opacity: 0.8;
            margin-bottom: 15px;
        }
        .tier-price {
            background: rgba(26, 15, 0, 0.7);
            border: 2px solid rgba(255, 215, 0, 0.5);
            border-radius: 12px;
            padding: 15px;
            margin: 4px 0 15px 0;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: left;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        .tier-price .main-price {
            font-size: 22px;
            color: #FFD700;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }
        .tier-price .usd-price {
            font-size: 13px;
            color: #FFA500;
            opacity: 0.9;
            margin-bottom: 6px;
        }
        .tier-price .next-price {
            font-size: 10px;
            color: #FFD700;
            opacity: 0.8;
        }
        .tier-boost {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #1a0f00;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            font-size: 11px;
            margin-bottom: 12px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
            animation: boostGoldPulse 2s ease-in-out infinite;
            font-weight: bold;
        }
        .passive-income {
            font-size: 11px;
            color: #FFD700;
            margin-bottom: 15px;
            text-align: left;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
        }
        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(26, 15, 0, 0.7);
            border-radius: 6px;
            margin: 10px 0;
            overflow: hidden;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #FFD700, #FFA500, #FFD700);
            transition: width 0.5s;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            animation: progressGoldShine 2s ease-in-out infinite;
        }
        .tier-minted-count {
            font-size: 10px;
            text-align: center;
            color: #FFD700;
            opacity: 0.8;
            margin-bottom: 15px;
        }
        .mint-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border: none;
            border-radius: 10px;
            color: #1a0f00;
            font-family: 'Press Start 2P', cursive;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: auto;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
            font-weight: bold;
        }
        .mint-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 50px rgba(255, 215, 0, 1), 0 0 70px rgba(255, 215, 0, 0.8);
        }
        .bronze-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: auto;
        }
        .bronze-btn {
            padding: 12px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border: none;
            border-radius: 10px;
            color: #1a0f00;
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
            font-weight: bold;
        }
        .bronze-btn.sol {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.6);
        }
        .bronze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 40px rgba(255, 215, 0, 1);
        }
        
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes goldShine {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
        }
        @keyframes goldCardGlow {
            0%, 100% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.6); }
            50% { box-shadow: 0 0 60px rgba(255, 215, 0, 0.9), 0 0 100px rgba(255, 215, 0, 0.6); }
        }
        @keyframes diamondGoldGlow {
            0%, 100% { box-shadow: 0 0 50px rgba(255, 215, 0, 0.8); }
            50% { box-shadow: 0 0 80px rgba(255, 215, 0, 1), 0 0 120px rgba(255, 215, 0, 0.9); }
        }
        @keyframes iconGoldFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        @keyframes goldPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.6); }
            50% { box-shadow: 0 0 40px rgba(255, 215, 0, 1), 0 0 60px rgba(255, 107, 53, 0.8); }
        }
        @keyframes boostGoldPulse {
            0%, 100% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.6); }
            50% { box-shadow: 0 0 50px rgba(255, 215, 0, 1), 0 0 70px rgba(255, 165, 0, 0.8); }
        }
        @keyframes progressGoldShine {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé® MINT YOUR NFT PET</h1>
            <div class="subtitle">5 TIERS | BONDING CURVE | FIXED BOOSTS</div>
        </div>
        
        <div class="wallet-section">
            <div class="wallet-info">
                <div>üëõ <span id="wallet-status">Connect Wallet</span></div>
                <div>SOL: <span id="sol-balance">0</span></div>
                <div>TAMA: <span id="tama-balance">Loading...</span></div>
            </div>
            <button class="btn-connect" onclick="connectWallet()">Connect Wallet</button>
        </div>
        
        <div class="tier-grid">
            <!-- Bronze Card -->
            <div class="tier-card bronze">
                <div class="tier-icon">üü´</div>
                <div class="tier-name">BRONZE</div>
                <div class="tier-supply">Common ¬∑ 4,500 available</div>
                <div class="tier-price">
                    <div class="main-price">5000 TAMA</div>
                    <div class="usd-price">$25</div>
                    <div class="next-price">or 0.15 SOL</div>
                </div>
                <div class="tier-boost">√ó2.0 EARNING</div>
                <div class="passive-income">üéÅ +50 TAMA/day</div>
                <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
                <div class="tier-minted-count">Minted: 0 / 4500</div>
                <div class="bronze-buttons">
                    <button class="bronze-btn" onclick="mintBronze()">FREE</button>
                    <button class="bronze-btn sol" onclick="mintBronzeSOL()">0.15 SOL</button>
                </div>
            </div>
            
            <!-- Silver Card -->
            <div class="tier-card silver">
                <div class="fomo-badge">üî• PRICE ‚Üë</div>
                <div class="tier-icon">ü•à</div>
                <div class="tier-name">SILVER</div>
                <div class="tier-supply">Uncommon ¬∑ 350 available</div>
                <div class="tier-price">
                    <div class="main-price"><span id="price-silver-sol">1</span> SOL</div>
                    <div class="usd-price">$<span id="price-silver-usd">164</span></div>
                    <div class="next-price">Next: <span id="next-silver">1.01</span> SOL (+0.6%)</div>
                </div>
                <div class="tier-boost">√ó2.3 EARNING</div>
                <div class="passive-income">üéÅ +150 TAMA/day</div>
                <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
                <div class="tier-minted-count">Minted: 0 / 350</div>
                <button class="mint-btn" onclick="mintSOL('Silver')">üíé MINT SILVER</button>
            </div>
            
            <!-- Gold Card -->
            <div class="tier-card gold">
                <div class="fomo-badge">üî• PRICE ‚Üë</div>
                <div class="tier-icon">ü•á</div>
                <div class="tier-name">GOLD</div>
                <div class="tier-supply">Rare ¬∑ 130 available</div>
                <div class="tier-price">
                    <div class="main-price"><span id="price-gold-sol">3</span> SOL</div>
                    <div class="usd-price">$<span id="price-gold-usd">492</span></div>
                    <div class="next-price">Next: <span id="next-gold">3.05</span> SOL (+1.8%)</div>
                </div>
                <div class="tier-boost">√ó2.7 EARNING</div>
                <div class="passive-income">üéÅ +500 TAMA/day</div>
                <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
                <div class="tier-minted-count">Minted: 0 / 130</div>
                <button class="mint-btn" onclick="mintSOL('Gold')">üèÜ MINT GOLD</button>
            </div>
            
            <!-- Platinum Card -->
            <div class="tier-card platinum">
                <div class="fomo-badge">üî• RARE!</div>
                <div class="tier-icon">üíé</div>
                <div class="tier-name">PLATINUM</div>
                <div class="tier-supply">Epic ¬∑ Only 18!</div>
                <div class="tier-price">
                    <div class="main-price"><span id="price-platinum-sol">10</span> SOL</div>
                    <div class="usd-price">$<span id="price-platinum-usd">1,641</span></div>
                    <div class="next-price">Next: <span id="next-platinum">11.11</span> SOL (+11%)</div>
                </div>
                <div class="tier-boost">√ó3.5 EARNING</div>
                <div class="passive-income">üéÅ +2000 TAMA/day</div>
                <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
                <div class="tier-minted-count">Minted: 0 / 18</div>
                <button class="mint-btn" onclick="mintSOL('Platinum')">‚ö° MINT PLATINUM</button>
            </div>
            
            <!-- Diamond Card -->
            <div class="tier-card diamond">
                <div class="fomo-badge">‚ö†Ô∏è ONLY 2!</div>
                <div class="tier-icon">üî∑</div>
                <div class="tier-name">DIAMOND</div>
                <div class="tier-supply">Legendary ¬∑ ONLY 2 EXIST!</div>
                <div class="tier-price">
                    <div class="main-price"><span id="price-diamond-sol">50</span> SOL</div>
                    <div class="usd-price">$<span id="price-diamond-usd">8,204</span></div>
                    <div class="next-price">Next: <span id="next-diamond">100</span> SOL (+100%)</div>
                </div>
                <div class="tier-boost">√ó5.0 MAXIMUM!</div>
                <div class="passive-income">üéÅ +10000 TAMA/day</div>
                <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
                <div class="tier-minted-count">Minted: 0 / 2</div>
                <button class="mint-btn" onclick="mintSOL('Diamond')">üëë MINT DIAMOND</button>
            </div>
        </div>
    </div>
    
    <script>
        // Same JavaScript as variant2
        const SUPABASE_URL = 'https://zfrazyupameidxpjihrh.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpmcmF6eXVwYW1laWR4cGppaHJoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzA1NzY0MDAsImV4cCI6MjA0NjE1MjQwMH0.8qJZqJZqJZqJZqJZqJZqJZqJZqJZqJZqJZqJZqJZqJZ';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        const TAMA_API_BASE = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
            ? 'http://localhost:8002/api/tama'
            : 'https://huma-chain-xyz.onrender.com/api/tama';
        const SOL_USD_RATE = 164.07;
        const TELEGRAM_USER_ID = getTelegramUserId();
        let walletConnected = false;
        let walletAddress = null;
        let tamaBalance = 0;
        function getTelegramUserId() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('user_id')) return parseInt(urlParams.get('user_id'));
            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe) {
                const user = window.Telegram.WebApp.initDataUnsafe.user;
                if (user && user.id) return user.id;
            }
            return 123456789;
        }
        async function connectWallet() {
            try {
                if (!window.solana || !window.solana.isPhantom) {
                    alert('Please install Phantom wallet!');
                    window.open('https://phantom.app/', '_blank');
                    return;
                }
                const resp = await window.solana.connect();
                walletAddress = resp.publicKey.toString();
                walletConnected = true;
                localStorage.setItem('phantom_wallet_address', walletAddress);
                document.getElementById('wallet-status').textContent = walletAddress.substring(0, 4) + '...' + walletAddress.substring(walletAddress.length - 4);
                const connection = new solanaWeb3.Connection('https://api.devnet.solana.com');
                const balance = await connection.getBalance(resp.publicKey);
                document.getElementById('sol-balance').textContent = (balance / 1e9).toFixed(4);
            } catch (err) {
                console.error('‚ùå Wallet connection failed:', err);
                alert('Failed to connect wallet!');
            }
        }
        async function loadPricesAndStats() {
            try {
                const { data: bondingData, error: bondingError } = await supabase.from('nft_bonding_state').select('*');
                if (bondingError) return;
                bondingData.forEach(tier => updateTierUI(tier));
                await loadTAMABalance();
            } catch (err) {
                console.error('‚ùå Error loading prices:', err);
            }
        }
        function updateTierUI(tier) {
            const tierName = tier.tier_name.toLowerCase();
            if (tierName === 'bronze_sol') {
                const bronzeUsdSpan = document.getElementById('price-bronze-usd');
                if (bronzeUsdSpan) bronzeUsdSpan.textContent = Math.round(0.15 * SOL_USD_RATE);
                return;
            }
            const mintedSpan = document.getElementById(`minted-${tierName}`);
            if (mintedSpan) mintedSpan.textContent = tier.minted_count;
            const maxSpan = document.getElementById(`max-${tierName}`);
            if (maxSpan) maxSpan.textContent = tier.max_supply;
            const progressFill = document.querySelector(`#tier-${tierName} .progress-fill`);
            if (progressFill) {
                const percentage = (tier.minted_count / tier.max_supply) * 100;
                progressFill.style.width = percentage + '%';
            }
            if (tier.payment_type === 'SOL') {
                const formatSOL = (num) => num % 1 === 0 ? num.toString() : num.toFixed(2);
                const solSpan = document.getElementById(`price-${tierName}-sol`);
                if (solSpan) solSpan.textContent = formatSOL(parseFloat(tier.current_price));
                const usdSpan = document.getElementById(`price-${tierName}-usd`);
                if (usdSpan) {
                    const usdPrice = parseFloat(tier.current_price) * SOL_USD_RATE;
                    usdSpan.textContent = Math.round(usdPrice).toLocaleString();
                }
                const nextSpan = document.getElementById(`next-${tierName}`);
                if (nextSpan) {
                    const nextPrice = parseFloat(tier.current_price) + parseFloat(tier.increment_per_mint);
                    nextSpan.textContent = formatSOL(nextPrice);
                }
            }
        }
        async function loadTAMABalance() {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const urlTama = urlParams.get('tama');
                if (urlTama) {
                    tamaBalance = parseInt(urlTama) || 0;
                    document.getElementById('tama-balance').textContent = tamaBalance.toLocaleString();
                    return;
                }
                if (!TELEGRAM_USER_ID) {
                    tamaBalance = 0;
                    document.getElementById('tama-balance').textContent = '0';
                    return;
                }
                const apiUrl = `${TAMA_API_BASE}/balance?telegram_id=${TELEGRAM_USER_ID}`;
                const response = await fetch(apiUrl);
                if (!response.ok) throw new Error(`API error: ${response.status}`);
                const result = await response.json();
                if (result.success) {
                    tamaBalance = result.database_tama || result.total_tama || 0;
                    document.getElementById('tama-balance').textContent = tamaBalance.toLocaleString();
                } else {
                    tamaBalance = 0;
                    document.getElementById('tama-balance').textContent = '0';
                }
            } catch (err) {
                tamaBalance = 0;
                document.getElementById('tama-balance').textContent = '0';
            }
        }
        async function mintBronze() {
            try {
                if (tamaBalance < 5000) {
                    alert(`Not enough TAMA! You need 5,000 TAMA.\nYour balance: ${tamaBalance} TAMA`);
                    return;
                }
                if (!confirm('Mint Bronze NFT for 5,000 TAMA?\n\nYou will get √ó2.0 earning boost!')) return;
                const apiUrl = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
                    ? 'api/mint-nft-bronze.php'
                    : 'https://huma-chain-xyz.onrender.com/api/mint-nft-bronze.php';
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ telegram_id: TELEGRAM_USER_ID })
                });
                if (!response.ok) throw new Error(`API error: ${response.status}`);
                const result = await response.json();
                if (result.success) {
                    alert(`üéâ SUCCESS!\n\nYou minted Bronze NFT #${result.design_number}!`);
                    await loadPricesAndStats();
                    await loadTAMABalance();
                } else {
                    alert(`‚ùå Error: ${result.error || 'Unknown error'}`);
                }
            } catch (err) {
                alert('Failed to mint Bronze NFT!');
            }
        }
        async function mintBronzeSOL() {
            try {
                if (!walletConnected) {
                    alert('Please connect your wallet first!');
                    return;
                }
                const bronzeSolPrice = 0.15;
                const priceUSD = (bronzeSolPrice * SOL_USD_RATE).toFixed(2);
                if (!confirm(`Mint Bronze NFT (Express) for ${bronzeSolPrice} SOL ($${priceUSD})?`)) return;
                const apiUrl = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
                    ? 'api/mint-nft-bronze-sol.php'
                    : 'https://huma-chain-xyz.onrender.com/api/mint-nft-bronze-sol.php';
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        telegram_id: TELEGRAM_USER_ID,
                        wallet_address: walletAddress,
                        price_sol: bronzeSolPrice
                    })
                });
                if (!response.ok) throw new Error(`API error: ${response.status}`);
                const result = await response.json();
                if (result.success) {
                    alert(`üéâ EXPRESS SUCCESS!\n\nYou minted Bronze NFT #${result.design_number}!`);
                    await loadPricesAndStats();
                    await loadTAMABalance();
                } else {
                    alert(`‚ùå Error: ${result.error || 'Unknown error'}`);
                }
            } catch (err) {
                alert('Failed to mint Bronze NFT (SOL)!');
            }
        }
        async function mintSOL(tierName) {
            try {
                if (!walletConnected) {
                    alert('Please connect your wallet first!');
                    return;
                }
                const { data: tierData, error } = await supabase
                    .from('nft_bonding_state')
                    .select('current_price')
                    .eq('tier_name', tierName)
                    .single();
                if (error || !tierData) {
                    alert('Failed to get current price!');
                    return;
                }
                const price = parseFloat(tierData.current_price);
                const priceUSD = (price * SOL_USD_RATE).toFixed(2);
                const boostMap = { 'Silver': 2.3, 'Gold': 2.7, 'Platinum': 3.5, 'Diamond': 5.0 };
                if (!confirm(`Mint ${tierName} NFT for ${price} SOL ($${priceUSD})?\n\nYou will get √ó${boostMap[tierName]} earning boost!`)) return;
                const apiUrl = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
                    ? 'api/mint-nft-sol.php'
                    : 'https://huma-chain-xyz.onrender.com/api/mint-nft-sol.php';
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        telegram_id: TELEGRAM_USER_ID,
                        wallet_address: walletAddress,
                        tier: tierName,
                        price_sol: price
                    })
                });
                if (!response.ok) throw new Error(`API error: ${response.status}`);
                const result = await response.json();
                if (result.success) {
                    alert(`üéâ SUCCESS!\n\nYou minted ${tierName} NFT #${result.design_number}!`);
                    await loadPricesAndStats();
                    await loadTAMABalance();
                } else {
                    alert(`‚ùå Error: ${result.error || 'Unknown error'}`);
                }
            } catch (err) {
                alert(`Failed to mint ${tierName} NFT!`);
            }
        }
        window.addEventListener('load', async () => {
            console.log('üöÄ NFT Mint Page loaded (Variant 5: Gold Premium)');
            try {
                const savedWallet = localStorage.getItem('phantom_wallet_address');
                if (savedWallet && window.solana && window.solana.isPhantom) {
                    try {
                        const resp = await window.solana.connect({ onlyIfTrusted: true });
                        if (resp && resp.publicKey) {
                            walletAddress = resp.publicKey.toString();
                            walletConnected = true;
                            document.getElementById('wallet-status').textContent = walletAddress.substring(0, 4) + '...' + walletAddress.substring(walletAddress.length - 4);
                            const connection = new solanaWeb3.Connection('https://api.devnet.solana.com');
                            const balance = await connection.getBalance(resp.publicKey);
                            document.getElementById('sol-balance').textContent = (balance / 1e9).toFixed(4);
                        }
                    } catch (err) {
                        console.log('‚ÑπÔ∏è Wallet not auto-connected');
                    }
                }
            } catch (err) {
                console.warn('‚ö†Ô∏è Failed to restore wallet:', err);
            }
            await loadPricesAndStats();
            await loadTAMABalance();
            setInterval(loadPricesAndStats, 10000);
            setInterval(loadTAMABalance, 30000);
        });
    </script>
</body>
</html>

