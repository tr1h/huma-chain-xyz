# üí∞ TAMA REWARD FLOW - –ö–ê–ö –ù–ê–ß–ò–°–õ–Ø–ï–¢–°–Ø TAMA

## ‚úÖ –î–ê, TAMA –ù–ê–ß–ò–°–õ–Ø–ï–¢–°–Ø!

---

## üîÑ –ü–û–õ–ù–´–ô –ü–†–û–¶–ï–°–° –ù–ê–ß–ò–°–õ–ï–ù–ò–Ø:

### **–®–ê–ì 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ**
```
User B ‚Üí –∫–ª–∏–∫–∞–µ—Ç ‚Üí https://solanatamagotchi.com/s.html?ref=TAMA44E30F
```

### **–®–ê–ì 2: –†–µ–¥–∏—Ä–µ–∫—Ç –≤ –±–æ—Ç**
```
s.html ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç ‚Üí https://t.me/gotchigamebot?start=refTAMA44E30F
```

### **–®–ê–ì 3: –ë–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç /start**
```python
# bot/bot.py —Å—Ç—Ä–æ–∫–∞ 582-689

1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç referral code: TAMA44E30F
2. –ù–∞—Ö–æ–¥–∏—Ç referrer_telegram_id –ø–æ –∫–æ–¥—É
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —ç—Ç–æ –Ω–æ–≤—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª (–Ω–µ –¥—É–±–ª–∏–∫–∞—Ç)
4. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ pending_referrals
```

### **–®–ê–ì 4: –ù–ê–ß–ò–°–õ–ï–ù–ò–ï TAMA (–ú–ì–ù–û–í–ï–ù–ù–û!)**
```python
# bot/bot.py —Å—Ç—Ä–æ–∫–∏ 643-660

1. –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å —Ä–µ—Ñ–µ—Ä–µ—Ä–∞:
   current_tama = referrer.get('tama', 0) or 0

2. –ü–æ–ª—É—á–∞–µ—Ç –Ω–∞–≥—Ä–∞–¥—É –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫:
   settings = get_referral_settings()
   referral_reward = settings.get('referral_reward', 1000)  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 1000

3. –í—ã—á–∏—Å–ª—è–µ—Ç –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å:
   new_tama = current_tama + referral_reward

4. –û–ë–ù–û–í–õ–Ø–ï–¢ –ë–ê–õ–ê–ù–° –í –ë–î:
   supabase.table('leaderboard').update({
       'tama': new_tama
   }).eq('telegram_id', referrer_telegram_id).execute()

5. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ referrals:
   - signup_reward: referral_reward (–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫)
   - reward_given: referral_reward (–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫)
```

### **–®–ê–ì 5: –ü–†–û–í–ï–†–ö–ê –ú–ò–õ–°–¢–û–£–ù–û–í**
```python
# bot/bot.py —Å—Ç—Ä–æ–∫–∏ 691-730

1. –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:
   total_referrals = active + pending

2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –º–∏–ª—Å—Ç–æ—É–Ω—ã (1, 3, 5, 10, 15, 25, 50, 75, 100, 150, 250, 500, 1000)

3. –ï—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –º–∏–ª—Å—Ç–æ—É–Ω:
   - –ü–æ–ª—É—á–∞–µ—Ç –Ω–∞–≥—Ä–∞–¥—É –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
   - –ù–∞—á–∏—Å–ª—è–µ—Ç –±–æ–Ω—É—Å TAMA
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–µ—Ä—É
```

---

## üìä –ì–î–ï –•–†–ê–ù–ò–¢–°–Ø:

### **1. –ë–∞–ª–∞–Ω—Å TAMA:**
- **–¢–∞–±–ª–∏—Ü–∞:** `leaderboard`
- **–ü–æ–ª–µ:** `tama` (BIGINT)
- **–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:** –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ—Ñ–µ—Ä–∞–ª–µ

### **2. –ò—Å—Ç–æ—Ä–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:**
- **–¢–∞–±–ª–∏—Ü–∞:** `referrals`
- **–ü–æ–ª—è:**
  - `signup_reward` - –Ω–∞–≥—Ä–∞–¥–∞ –∑–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–∞ (–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫)
  - `reward_given` - —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–æ
  - `status` - 'completed'

### **3. –û–∂–∏–¥–∞—é—â–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—ã:**
- **–¢–∞–±–ª–∏—Ü–∞:** `pending_referrals`
- **–°—Ç–∞—Ç—É—Å:** 'pending' (–¥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞)

---

## ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò (–ß–ï–†–ï–ó –ê–î–ú–ò–ù–ö–£):

### **–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤:**
- **–¢–∞–±–ª–∏—Ü–∞:** `referral_settings`
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** `admin-referrals.html` ‚Üí –≤–∫–ª–∞–¥–∫–∞ "‚öôÔ∏è Settings"

### **–ß—Ç–æ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å:**
1. **referral_reward** - TAMA –∑–∞ –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1000)
2. **milestone_1** - –±–æ–Ω—É—Å –∑–∞ 1 —Ä–µ—Ñ–µ—Ä–∞–ª–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 500)
3. **milestone_3** - –±–æ–Ω—É—Å –∑–∞ 3 —Ä–µ—Ñ–µ—Ä–∞–ª–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 750)
4. ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ –¥–ª—è –≤—Å–µ—Ö 13 –º–∏–ª—Å—Ç–æ—É–Ω–æ–≤

---

## üîç –ü–†–û–í–ï–†–ö–ê –ù–ê–ß–ò–°–õ–ï–ù–ò–Ø:

### **1. –í –ª–æ–≥–∞—Ö –±–æ—Ç–∞:**
```
üí∞ Awarded {referral_reward} TAMA to {referrer_telegram_id} (new balance: {new_tama})
‚úÖ Created referral record for {referrer_telegram_id} -> {user_id}
```

### **2. –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å —Ä–µ—Ñ–µ—Ä–µ—Ä–∞
SELECT telegram_id, telegram_username, tama 
FROM leaderboard 
WHERE telegram_id = '{referrer_telegram_id}';

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
SELECT * FROM referrals 
WHERE referrer_telegram_id = '{referrer_telegram_id}'
ORDER BY created_at DESC;
```

### **3. –í –∞–¥–º–∏–Ω–∫–µ:**
- `admin-referrals.html` ‚Üí –≤–∫–ª–∞–¥–∫–∞ "üìä Overview"
- –ö–æ–ª–æ–Ω–∫–∞ "Earnings" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—â–∏–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫

---

## ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï:

**–î–ê, TAMA –ù–ê–ß–ò–°–õ–Ø–ï–¢–°–Ø:**
- ‚úÖ –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
- ‚úÖ –ë–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –ë–î (–º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –≤ –∞–¥–º–∏–Ω–∫–µ)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `leaderboard.tama`
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `referrals`

---

## üö® –í–ê–ñ–ù–û:

1. **–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –î–û —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ referrals**
2. **–ï—Å–ª–∏ —Ä–µ—Ñ–µ—Ä–∞–ª —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –Ω–∞–≥—Ä–∞–¥–∞ –ù–ï –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ**
3. **–ù–∞–≥—Ä–∞–¥–∞ –±–µ—Ä–µ—Ç—Å—è –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ë–î (–Ω–µ hardcoded)**
4. **–ú–∏–ª—Å—Ç–æ—É–Ω—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–∞–≥—Ä–∞–¥–µ**

---

## üìà –ü–†–ò–ú–ï–†:

```
User A –∏–º–µ–µ—Ç: 5,000 TAMA
User B —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ —Å—Å—ã–ª–∫–µ User A

1. User A –ø–æ–ª—É—á–∞–µ—Ç: 1,000 TAMA (referral_reward)
   –ù–æ–≤—ã–π –±–∞–ª–∞–Ω—Å: 6,000 TAMA ‚úÖ

2. –ï—Å–ª–∏ —ç—Ç–æ 5-–π —Ä–µ—Ñ–µ—Ä–∞–ª User A:
   User A –ø–æ–ª—É—á–∞–µ—Ç: +1,000 TAMA (milestone_5)
   –ù–æ–≤—ã–π –±–∞–ª–∞–Ω—Å: 7,000 TAMA ‚úÖ

–ò–¢–û–ì–û: User A –ø–æ–ª—É—á–∏–ª 2,000 TAMA –∑–∞ –æ–¥–Ω–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞!
```

