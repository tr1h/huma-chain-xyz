# üîç –ê–£–î–ò–¢ –°–ò–°–¢–ï–ú–´ –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø –¢–†–ê–ù–ó–ê–ö–¶–ò–ô

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ù–ê–ô–î–ï–ù–´!

---

## ‚úÖ –ß–¢–û –õ–û–ì–ò–†–£–ï–¢–°–Ø –ü–†–ê–í–ò–õ–¨–ù–û:

### 1. **–ó–∞—Ä–∞–±–æ—Ç–æ–∫ / –¢—Ä–∞—Ç—ã –≤ –∏–≥—Ä–µ:**

- ‚úÖ `earn_click` - –∫–ª–∏–∫–∏ –ø–æ –ø–∏—Ç–æ–º—Ü—É (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `spend_feed` - –ø–æ–∫—É–ø–∫–∞ –µ–¥—ã (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `spend_play` - –∏–≥—Ä–∞ —Å –ø–∏—Ç–æ–º—Ü–µ–º (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `spend_heal` - –ª–µ—á–µ–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞ (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)

### 2. **–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –∫–≤–µ—Å—Ç—ã:**

- ‚úÖ `achievement_bonus` - –±–æ–Ω—É—Å—ã –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `quest_complete` - –Ω–∞–≥—Ä–∞–¥—ã –∑–∞ –∫–≤–µ—Å—Ç—ã (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è 2 —Ç–∏–ø–∞)

### 3. **–ú–∏–Ω–∏-–∏–≥—Ä—ã (P2E):**

- ‚úÖ `earn_slots`, `spend_slots` - Slot Machine (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `earn_wheel`, `spend_wheel` - Lucky Wheel (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `earn_catchpet` - Catch the Pet (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `earn_battle`, `spend_battle`, `lose_battle` - Pet Battle (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `earn_racing`, `spend_racing`, `lose_racing` - Pet Racing (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `earn_tower`, `spend_tower` - TAMA Tower (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `earn_precision`, `spend_precision` - Precision Click (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `earn_roulette`, `spend_roulette` - Roulette (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `earn_cards`, `spend_cards` - Card Game (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `spend_battle_bet`, `refund_battle_bet` - PVP —Å—Ç–∞–≤–∫–∏ (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `spend_racing_bet` - Racing —Å—Ç–∞–≤–∫–∏ (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)

### 4. **NFT (—á–µ—Ä–µ–∑ API):**

- ‚úÖ `nft_mint_sol` - –º–∏–Ω—Ç NFT –∑–∞ SOL (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ API)
- ‚úÖ `nft_mint_tama` - –º–∏–Ω—Ç NFT –∑–∞ TAMA (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ API)
- ‚úÖ `treasury_income_from_nft` - –¥–æ—Ö–æ–¥ –∫–∞–∑–Ω—ã (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `p2e_pool_refund_from_nft` - –≤–æ–∑–≤—Ä–∞—Ç –≤ P2E –ø—É–ª (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `burn_from_bronze_nft_onchain` - —Å–∂–∏–≥–∞–Ω–∏–µ TAMA (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è)

### 5. **–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤:**

- ‚úÖ `p2e_pool_withdrawal` - –≤—ã–≤–æ–¥ TAMA (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ API)

---

## ‚ùå –ß–¢–û –ù–ï –õ–û–ì–ò–†–£–ï–¢–°–Ø (–ö–†–ò–¢–ò–ß–ù–û!):

### 1. **üõí –ü–û–ö–£–ü–ö–ò –í –ú–ê–ì–ê–ó–ò–ù–ï:**

```javascript
function buyItem(itemType, price) {
  // ... –∫–æ–¥ —Å–ø–∏—Å–∞–Ω–∏—è TAMA ...
  gameState.tama -= price;

  // ‚ùå –ù–ï–¢ –≤—ã–∑–æ–≤–∞ logTransaction!
  // –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: logTransaction('spend_shop', price, balanceBefore, balanceAfter, {...})
}
```

**–ù–ï –õ–û–ì–ò–†–£–Æ–¢–°–Ø:**

- ‚ùå –ü–æ–∫—É–ø–∫–∞ Energy Drink
- ‚ùå –ü–æ–∫—É–ø–∫–∞ Auto-Feeder (500 TAMA!)
- ‚ùå –ü–æ–∫—É–ø–∫–∞ 2x TAMA Booster

**–ü–û–¢–ï–†–Ø:** ~1,000+ TAMA —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è!

---

### 2. **üé® –ü–û–ö–£–ü–ö–ê –°–ö–ò–ù–û–í (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!):**

```javascript
function buySkin(skinId) {
    // ... –∫–æ–¥ —Å–ø–∏—Å–∞–Ω–∏—è TAMA ...
    gameState.tama -= skin.price;

    // ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ô –≤—ã–∑–æ–≤:
    logTransaction(
        window.Telegram?.WebApp?.initDataUnsafe?.user?.username || 'user', // ‚ùå –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å type!
        'skin_' + skinId,  // ‚ùå –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—É–º–º–∞!
        skin.price,
        balanceBefore,
        balanceAfter,
        {...}
    );
}
```

**–ü–†–û–ë–õ–ï–ú–ê:** –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ!

- –ü–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `type` (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'spend_skin')
- –í—Ç–æ—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä - `amount`
- –ù–æ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è `username` –≤–º–µ—Å—Ç–æ `type`!

**–†–ï–ó–£–õ–¨–¢–ê–¢:** –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–∫–∏–Ω–æ–≤ **–ù–ï –ó–ê–ü–ò–°–´–í–ê–Æ–¢–°–Ø** –∏–ª–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è **–ù–ï–ö–û–†–†–ï–ö–¢–ù–û**!

**–ü–û–¢–ï–†–Ø:** 8,000 - 100,000 TAMA —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è!

---

### 3. **üìä LEVEL UP (–ù–ï–ò–ó–í–ï–°–¢–ù–û):**

```javascript
function checkLevelUp() {
    // ...
    TransactionLogger.logLevelUp(...);  // ‚ùå –ß—Ç–æ —ç—Ç–æ? –ù–µ –Ω–∞–π–¥–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è!
}
```

**–ü–†–û–ë–õ–ï–ú–ê:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `TransactionLogger.logLevelUp()`, –Ω–æ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è **–ù–ï –û–ü–†–ï–î–ï–õ–ï–ù–ê** –Ω–∏–≥–¥–µ –≤ –∫–æ–¥–µ!

**–†–ï–ó–£–õ–¨–¢–ê–¢:** Level Up –±–æ–Ω—É—Å—ã **–ù–ï –õ–û–ì–ò–†–£–Æ–¢–°–Ø**!

**–ü–û–¢–ï–†–Ø:** 1,000+ TAMA –±–æ–Ω—É—Å–æ–≤ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è!

---

### 4. **üîó –†–ï–§–ï–†–ê–õ–´ (–ù–ï–ò–ó–í–ï–°–¢–ù–û):**

–†–µ—Ñ–µ—Ä–∞–ª—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ API (`wallet-auth.php`), –Ω–æ **–ù–ï–¢ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø** —á—Ç–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `transactions`.

**–ù–£–ñ–ù–û –ü–†–û–í–ï–†–ò–¢–¨:**

- –õ–æ–≥–∏—Ä—É—é—Ç—Å—è –ª–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –±–æ–Ω—É—Å—ã –≤ `transactions`?
- –ï—Å—Ç—å –ª–∏ —Ç–∏–ø `referral_bonus` –≤ –±–∞–∑–µ?

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û–¢–ï–†–¨:

| –¢–∏–ø —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏     | –°—Ç–∞—Ç—É—Å           | –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö |
| ------------------ | ---------------- | ------------- |
| –ü–æ–∫—É–ø–∫–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ | ‚ùå –ù–ï –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è | ~1,000 TAMA   |
| –ü–æ–∫—É–ø–∫–∞ —Å–∫–∏–Ω–æ–≤     | ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û   | 8K-100K TAMA  |
| Level Up –±–æ–Ω—É—Å—ã    | ‚ùå –ù–ï –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è | ~1,000 TAMA   |
| –†–µ—Ñ–µ—Ä–∞–ª—ã           | ‚ö†Ô∏è –ù–ï–ò–ó–í–ï–°–¢–ù–û    | ? TAMA        |

**–ò–¢–û–ì–û:** –ú–∏–Ω–∏–º—É–º **10,000+ TAMA —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è!

---

## üîß –ß–¢–û –ù–£–ñ–ù–û –ò–°–ü–†–ê–í–ò–¢–¨:

### 1. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ buyItem():**

```javascript
function buyItem(itemType, price) {
  const balanceBefore = gameState.tama;
  gameState.tama -= price;
  const balanceAfter = gameState.tama;

  // ‚úÖ –î–û–ë–ê–í–ò–¢–¨:
  if (window.TELEGRAM_USER_ID) {
    logTransaction('spend_shop', price, balanceBefore, balanceAfter, {
      item_type: itemType,
      item_name: getItemName(itemType),
    });
  }

  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}
```

### 2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å buyS kin():**

```javascript
function buySkin(skinId) {
  const skin = getSkin(skinId);
  const balanceBefore = gameState.tama;
  gameState.tama -= skin.price;
  const balanceAfter = gameState.tama;

  // ‚úÖ –ò–°–ü–†–ê–í–ò–¢–¨ (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤):
  if (typeof logTransaction === 'function') {
    logTransaction(
      'spend_skin', // ‚úÖ type
      skin.price, // ‚úÖ amount
      balanceBefore, // ‚úÖ balance_before
      balanceAfter, // ‚úÖ balance_after
      {
        // ‚úÖ metadata
        skin_id: skinId,
        skin_name: skin.nameRu,
        rarity: skin.rarity,
      }
    );
  }

  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}
```

### 3. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Level Up:**

```javascript
function checkLevelUp() {
  // ... –∫–æ–¥ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è ...

  // ‚úÖ –î–û–ë–ê–í–ò–¢–¨:
  const levelBonus = gameState.level * 100;
  const balanceBefore = gameState.tama;
  gameState.tama += levelBonus;
  const balanceAfter = gameState.tama;

  if (window.TELEGRAM_USER_ID) {
    logTransaction('level_up', levelBonus, balanceBefore, balanceAfter, {
      new_level: gameState.level,
      bonus_amount: levelBonus,
    });
  }
}
```

### 4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª—ã:**

–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª `api/wallet-auth.php` –∏ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –±–æ–Ω—É—Å—ã –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ `transactions`.

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô:

1. **üî¥ –ö–†–ò–¢–ò–ß–ù–û:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å buyItem() - –ù–ï –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è
2. **üî¥ –ö–†–ò–¢–ò–ß–ù–û:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å buySkin() - –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è
3. **üü° –í–ê–ñ–ù–û:** –î–æ–±–∞–≤–∏—Ç—å logTransaction –≤ checkLevelUp()
4. **üü° –í–ê–ñ–ù–û:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª—ã

---

## üìù –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:

### 1. **–î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã –≤ —Ñ–∏–ª—å—Ç—Ä transactions-admin.html:**

```html
<option value="shop">Shop Purchases</option>
<option value="skin">Skin Purchases</option>
```

### 2. **–°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**

–í—Å–µ –ø–æ–∫—É–ø–∫–∏ –¥–æ–ª–∂–Ω—ã –≤—ã–∑—ã–≤–∞—Ç—å –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é `logPurchase(type, amount, metadata)` –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.

### 3. **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**

–î–æ–±–∞–≤–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –Ω–∞ dashboard –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ—Ç–µ—Ä—å.

---

## ‚úÖ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:

1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å buyItem() - –¥–æ–±–∞–≤–∏—Ç—å logTransaction
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å buySkin() - –ø–æ–ø—Ä–∞–≤–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å checkLevelUp() - –¥–æ–±–∞–≤–∏—Ç—å logTransaction
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å wallet-auth.php - —Ä–µ—Ñ–µ—Ä–∞–ª—ã
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
6. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ production

---

**–î–ê–¢–ê –ê–£–î–ò–¢–ê:** 2025-12-06
**–ö–†–ò–¢–ò–ß–ù–û–°–¢–¨:** üî¥ –í–´–°–û–ö–ê–Ø
**–°–¢–ê–¢–£–°:** ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –ù–ï–ú–ï–î–õ–ï–ù–ù–û–ì–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø
