# 💰 МЕХАНИКА РЕАЛЬНОГО ПУЛА: КАК ЭТО РАБОТАЕТ

## ❓ ВОПРОС: "Из основного пула (400M) ПУЛ ТО ЕСТЬ НАСТОЯЩИЙ и уменьшаться будет после вывода т.е после минта. По факту! Если нет выводов и не уменьшается настоящий пул. Так ли?"

**ОТВЕТ:** ДА! Объясняю механику реального пула! ✅

---

## 🎯 КАК РАБОТАЕТ СИСТЕМА

### 1. Основной пул (400M) - НАСТОЯЩИЙ:

```
┌─────────────────────────────────────────┐
│  ОСНОВНОЙ ПУЛ (400M)                    │
│  Место: Solana Blockchain               │
│  Адрес: p2e-pool-keypair.json           │
│  Статус: РЕАЛЬНЫЙ пул на блокчейне      │
│  Баланс: 400,000,000 TAMA               │
└─────────────────────────────────────────┘
```

### 2. Daily Pool - ВИРТУАЛЬНОЕ распределение:

```
┌─────────────────────────────────────────┐
│  DAILY POOL (800,000 TAMA/день)        │
│  Место: База данных (Supabase)         │
│  Статус: ВИРТУАЛЬНОЕ распределение      │
│  Действие: Запись в leaderboard.tama   │
└─────────────────────────────────────────┘
```

### 3. Вывод - РЕАЛЬНАЯ транзакция:

```
┌─────────────────────────────────────────┐
│  ВЫВОД                                  │
│  Действие: spl-token transfer           │
│  Откуда: p2e-pool-keypair.json         │
│  Куда: user_wallet                      │
│  Статус: РЕАЛЬНАЯ транзакция на блокчейне│
└─────────────────────────────────────────┘
```

---

## 📊 ЖИЗНЕННЫЙ ЦИКЛ

### Сценарий 1: Нет выводов (30 дней)

```
День 1-30:
├─ Daily Pool: 800,000 TAMA/день (виртуальное)
├─ Распределено: 24,000,000 TAMA (виртуальные)
├─ Выводов: 0
│
├─ В базе данных:
│  └─ leaderboard.tama += их доля (виртуальные)
│
├─ На блокчейне:
│  ├─ Основной пул: 400,000,000 TAMA ✅ (НЕ изменился!)
│  └─ User wallets: 0 TAMA (ничего не создано)
│
└─ РЕЗУЛЬТАТ:
   ✅ Основной пул НЕ уменьшился!
   ✅ Реальные токены НЕ созданы!
   ✅ Только виртуальные в базе!
```

### Сценарий 2: Есть выводы (30 дней)

```
День 1-30:
├─ Daily Pool: 800,000 TAMA/день (виртуальное)
├─ Распределено: 24,000,000 TAMA (виртуальные)
├─ Выводов: 12,000,000 TAMA (50%)
│
├─ В базе данных:
│  ├─ leaderboard.tama += их доля (виртуальные)
│  └─ leaderboard.tama -= 12M (виртуальные сгорели)
│
├─ На блокчейне:
│  ├─ Основной пул: 400M - 11.4M = 388.6M TAMA ✅ (уменьшился!)
│  │  └─ spl-token transfer из пула в user wallets
│  └─ User wallets: 11,400,000 TAMA (реальные созданы)
│
└─ РЕЗУЛЬТАТ:
   ✅ Основной пул УМЕНЬШИЛСЯ!
   ✅ Реальные токены СОЗДАНЫ!
   ✅ Виртуальные сгорели!
```

---

## 🔄 МЕХАНИКА ВЫВОДА

### Что происходит при выводе:

```
ШАГ 1: Проверка виртуальных
├─ База: leaderboard.tama >= amount ✅
└─ Виртуальные есть

ШАГ 2: Списать виртуальные
├─ База: leaderboard.tama -= amount
└─ Виртуальные СГОРЕЛИ ✅

ШАГ 3: Перевести из РЕАЛЬНОГО пула
├─ spl-token transfer
├─ Откуда: p2e-pool-keypair.json (РЕАЛЬНЫЙ пул)
├─ Куда: user_wallet
├─ Amount: amount_sent (после fee)
└─ РЕАЛЬНЫЙ пул УМЕНЬШИЛСЯ ✅

ШАГ 4: Fee распределение
├─ Fee: amount * 0.05
├─ Burn (40%): fee * 0.40 → сжигается
├─ Pool (50%): fee * 0.50 → возврат в пул
└─ Team (10%): fee * 0.10 → команде
```

---

## 💡 КЛЮЧЕВЫЕ ПОНИМАНИЯ

### 1. Основной пул (400M) - НАСТОЯЩИЙ:

```
✅ ДА! Это РЕАЛЬНЫЙ пул на блокчейне
✅ Адрес: p2e-pool-keypair.json
✅ Баланс: 400,000,000 TAMA (реальные токены)
✅ Уменьшается при выводе
✅ НЕ уменьшается если нет выводов
```

### 2. Daily Pool - ВИРТУАЛЬНОЕ:

```
✅ Это ВИРТУАЛЬНОЕ распределение
✅ Записывается в базу данных
✅ НЕ трогает реальный пул
✅ Только запись: leaderboard.tama += их доля
```

### 3. Вывод - РЕАЛЬНАЯ транзакция:

```
✅ При выводе: spl-token transfer
✅ Откуда: p2e-pool-keypair.json (РЕАЛЬНЫЙ пул)
✅ Куда: user_wallet
✅ РЕАЛЬНЫЙ пул УМЕНЬШИЛСЯ ✅
```

---

## 📈 ПРИМЕРЫ

### Пример 1: Нет выводов (30 дней)

```
День 1-30:
├─ Daily Pool: 800,000 TAMA/день
├─ Распределено: 24,000,000 TAMA (виртуальные)
├─ Выводов: 0

На блокчейне:
├─ Основной пул: 400,000,000 TAMA ✅ (НЕ изменился!)
└─ User wallets: 0 TAMA

В базе данных:
└─ leaderboard.tama = 24M (виртуальные)

РЕЗУЛЬТАТ:
✅ Основной пул НЕ уменьшился!
✅ Реальные токены НЕ созданы!
```

### Пример 2: Есть выводы (30 дней)

```
День 1-30:
├─ Daily Pool: 800,000 TAMA/день
├─ Распределено: 24,000,000 TAMA (виртуальные)
├─ Выводов: 12,000,000 TAMA (50%)

На блокчейне:
├─ Основной пул: 400M - 11.4M = 388.6M TAMA ✅ (уменьшился!)
│  └─ spl-token transfer из пула
└─ User wallets: 11,400,000 TAMA (реальные)

В базе данных:
└─ leaderboard.tama = 12M (виртуальные остались)

РЕЗУЛЬТАТ:
✅ Основной пул УМЕНЬШИЛСЯ!
✅ Реальные токены СОЗДАНЫ!
```

---

## 🎯 ОТВЕТЫ НА ВОПРОСЫ

### 1. "Из основного пула (400M) ПУЛ ТО ЕСТЬ НАСТОЯЩИЙ"

```
✅ ДА! Основной пул (400M) - это НАСТОЯЩИЙ пул на блокчейне
✅ Адрес: p2e-pool-keypair.json
✅ Баланс: 400,000,000 TAMA (реальные токены)
✅ Место: Solana Blockchain
```

### 2. "Уменьшаться будет после вывода т.е после минта"

```
✅ ДА! При выводе:
├─ spl-token transfer из пула
├─ Основной пул УМЕНЬШИЛСЯ
└─ Реальные токены переведены в user wallets
```

### 3. "По факту! Если нет выводов и не уменьшается настоящий пул"

```
✅ ДА! Если нет выводов:
├─ Основной пул НЕ уменьшается
├─ Реальные токены НЕ создаются
├─ Только виртуальные в базе данных
└─ Пул остаётся 400M ✅
```

---

## 📊 ВИЗУАЛИЗАЦИЯ

```
┌─────────────────────────────────────────┐
│  ОСНОВНОЙ ПУЛ (400M) - НАСТОЯЩИЙ        │
│  Место: Solana Blockchain               │
│  Адрес: p2e-pool-keypair.json           │
│  Баланс: 400,000,000 TAMA               │
└──────────────┬──────────────────────────┘
               │
               │ Daily Pool (виртуальное)
               │ НЕ трогает пул!
               ↓
┌─────────────────────────────────────────┐
│  ВИРТУАЛЬНЫЕ ТОКЕНЫ                     │
│  Место: Supabase (база данных)         │
│  Статус: Виртуальные (до вывода)        │
│  Пример: leaderboard.tama = 10000       │
└──────────────┬──────────────────────────┘
               │
               │ Вывод
               │ spl-token transfer
               ↓
┌─────────────────────────────────────────┐
│  РЕАЛЬНЫЕ ТОКЕНЫ                        │
│  Место: Solana Blockchain              │
│  Статус: Реальные (на блокчейне)        │
│  Пример: User Wallet = 9500 TAMA       │
│                                         │
│  Основной пул: 400M - 9.5k = 399.99M ✅│
└─────────────────────────────────────────┘
```

---

## ✅ ИТОГО

### Основной пул (400M):

```
✅ НАСТОЯЩИЙ пул на блокчейне
✅ Уменьшается при выводе
✅ НЕ уменьшается если нет выводов
✅ Место: p2e-pool-keypair.json
```

### Daily Pool:

```
✅ ВИРТУАЛЬНОЕ распределение
✅ НЕ трогает реальный пул
✅ Только запись в базу данных
```

### Вывод:

```
✅ РЕАЛЬНАЯ транзакция
✅ spl-token transfer из пула
✅ Основной пул УМЕНЬШИЛСЯ
✅ Реальные токены созданы
```

---

**ДА! Основной пул НАСТОЯЩИЙ и уменьшается только при выводе!** ✅

