# üîê Unified Authentication System

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

### **–ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü:**
1. **Telegram WebApp** (–∏–∑ –±–æ—Ç–∞) - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
2. **Telegram Login Widget** (–ø—Ä—è–º–æ–π –∑–∞—Ö–æ–¥) - –∫–Ω–æ–ø–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
3. **Phantom Wallet** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
4. **Session Management** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –Ω–∞ 7 –¥–Ω–µ–π
5. **Profile Widget** - –≤–∏–¥–∂–µ—Ç –ø—Ä–æ—Ñ–∏–ª—è –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

---

## üìÅ –§–∞–π–ª—ã:

### **`js/auth.js`** - –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (WebApp/Widget/Wallet)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ï–¥–∏–Ω—ã–π API –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

### **`js/profile-widget.js`** - –í–∏–¥–∂–µ—Ç –ø—Ä–æ—Ñ–∏–ª—è
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç: Telegram username, TAMA balance, Wallet
- –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏: Settings, My NFTs
- –ú–æ–∂–Ω–æ —Å–∫—Ä—ã—Ç—å (–∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –≤ localStorage)

---

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ò–∑ –∏–≥—Ä—ã (Telegram WebApp)**
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∏–≥—Ä—É –≤ –±–æ—Ç–µ
2. Telegram WebApp –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç user data
3. auth.js –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç WebApp –∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç
4. –ü—Ä–æ—Ñ–∏–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
5. –í–∏–¥–∂–µ—Ç –ø—Ä–æ—Ñ–∏–ª—è –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü—Ä—è–º–æ–π –∑–∞—Ö–æ–¥ (–∫–æ–º–ø—å—é—Ç–µ—Ä)**
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–∞–π—Ç –Ω–∞–ø—Ä—è–º—É—é
2. auth.js –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Å–µ—Å—Å–∏—é
3. –ï—Å–ª–∏ —Å–µ—Å—Å–∏–∏ –Ω–µ—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç Telegram Login Widget
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ –≤–∏–¥–∂–µ—Ç
5. –°–µ—Å—Å–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ 7 –¥–Ω–µ–π
6. –í–∏–¥–∂–µ—Ç –ø—Ä–æ—Ñ–∏–ª—è –ø–æ—è–≤–ª—è–µ—Ç—Å—è
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –° –∫–æ—à–µ–ª—å–∫–æ–º (Phantom)**
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–∫–ª—é—á–∞–µ—Ç Phantom
2. auth.js –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–≤—è–∑–∞–Ω –ª–∏ –∫–æ—à–µ–ª–µ–∫ —Å Telegram
3. –ï—Å–ª–∏ —Å–≤—è–∑–∞–Ω - –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å Telegram
4. –ï—Å–ª–∏ –Ω–µ—Ç - —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ—à–µ–ª—å–∫–∞
5. –ú–æ–∂–Ω–æ –ø—Ä–∏–≤—è–∑–∞—Ç—å Telegram –ø–æ–∑–∂–µ
```

---

## üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:**
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ü—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ TAMA)
- –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏

### **–†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:**
- –ö–Ω–æ–ø–∫–∞ "üîÑ SYNC NOW" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ—Ñ–∏–ª—è
- –û–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã

---

## üì± –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö:

### **–í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—É—é —Å–∏—Å—Ç–µ–º—É:**

```html
<!-- –î–æ–±–∞–≤–∏—Ç—å –≤ <head> -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/auth.js"></script>
<script src="js/profile-widget.js"></script>
```

### **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ:**

```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
if (window.GotchiAuth && window.GotchiAuth.isAuthenticated()) {
    const telegramId = window.GotchiAuth.getTelegramId();
    const walletAddress = window.GotchiAuth.getWalletAddress();
    const profile = window.GotchiAuth.getUserProfile();
}

// –î–æ–∂–¥–∞—Ç—å—Å—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
window.addEventListener('gotchiAuthReady', (e) => {
    const authResult = e.detail;
    if (authResult.success) {
        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
    }
});

// –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
await window.GotchiAuth.syncProfile();
```

---

## üé® –í–∏–¥–∂–µ—Ç –ø—Ä–æ—Ñ–∏–ª—è:

### **–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:**
- –í –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ú–æ–∂–Ω–æ —Å–∫—Ä—ã—Ç—å (–∫–Ω–æ–ø–∫–∞ √ó)

### **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- Telegram username –∏–ª–∏ ID
- –ë–∞–ª–∞–Ω—Å TAMA (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫)
- –ê–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞ (–µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω)
- –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏: Settings, My NFTs

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞:

### **1. Telegram Login Widget:**
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º–µ–Ω –≤ @BotFather
- –î–æ–º–µ–Ω: `solanatamagotchi.com`
- –ë–æ—Ç: `@GotchiGameBot`

### **2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
- –í—ã–ø–æ–ª–Ω–∏—Ç—å SQL —Å–∫—Ä–∏–ø—Ç: `sql/add_twitter_username_column.sql`
- –î–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–ª–æ–Ω–∫—É `twitter_username` –≤ `leaderboard`

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –û—Ç–∫—Ä—ã—Ç—å –ª—é–±—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å: `üîê Auth initialized`
3. –í–∏–¥–∂–µ—Ç –ø—Ä–æ—Ñ–∏–ª—è –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

---

## üìä –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:

1. **Telegram WebApp** (–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
   - –ò–∑ –±–æ—Ç–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
   - –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è**
   - –ò–∑ localStorage
   - –î–µ–π—Å—Ç–≤—É–µ—Ç 7 –¥–Ω–µ–π
   - –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

3. **URL –ø–∞—Ä–∞–º–µ—Ç—Ä** (`?user_id=...`)
   - –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∏–∑ –±–æ—Ç–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

4. **Telegram Login Widget**
   - –ü—Ä—è–º–æ–π –∑–∞—Ö–æ–¥
   - –¢—Ä–µ–±—É–µ—Ç –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏

5. **Phantom Wallet (auto)**
   - –ï—Å–ª–∏ —É–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–≤—è–∑—å —Å Telegram

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **–ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** - –æ–¥–∏–Ω –∫–æ–¥ –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - –Ω–µ –Ω—É–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã
4. **–í–∏–¥–∂–µ—Ç –ø—Ä–æ—Ñ–∏–ª—è** - –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
5. **Session management** - –Ω–µ –Ω—É–∂–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑
6. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ (WebApp, –±—Ä–∞—É–∑–µ—Ä, –º–æ–±–∏–ª—å–Ω—ã–π)

---

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–º–µ–Ω–∞ –≤ BotFather –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL —Å–∫—Ä–∏–ø—Ç–∞, —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö!

